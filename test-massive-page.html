<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromegg - Massive Form Test (Forces Multi-Scan)</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen py-8">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-4">Massive Form Test</h1>
        <p class="text-gray-600 mb-6">
            This page contains 2000 text fields with large random strings to force YAML chunking and multiscan endpoint usage.
            Each field has ~1KB of data, totaling ~2MB of content.
        </p>

        <div class="bg-blue-50 border border-blue-200 rounded p-4 mb-6">
            <p class="text-sm text-blue-800">
                <strong>Expected behavior:</strong>
                <ul class="list-disc ml-5 mt-2">
                    <li>Content will exceed 1MB and be split into chunks</li>
                    <li>Each chunk will contain up to ~1000 fields</li>
                    <li>Extension will use <code>/v1/multiscan</code> endpoint</li>
                    <li>Check console for: "Content split into X chunk(s)"</li>
                </ul>
            </p>
        </div>

        <form id="massive-form" class="space-y-2">
            <!-- Fields will be generated by JavaScript -->
        </form>
    </div>

    <script>
        // Generate random string of specified length
        function randomString(length) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // Generate a random secret-like string occasionally
        function randomValue(index) {
            // Every 100th field gets a fake secret
            if (index % 100 === 0) {
                return `Bearer ${randomString(32)}`;
            }
            // Most fields get 1KB of random data
            return randomString(1024);
        }

        // Generate 2000 text fields
        const form = document.getElementById('massive-form');
        const fieldCount = 2000;

        console.log(`Generating ${fieldCount} fields with ~1KB each...`);

        for (let i = 0; i < fieldCount; i++) {
            const fieldDiv = document.createElement('div');
            fieldDiv.className = 'flex items-center gap-2';

            const label = document.createElement('label');
            label.textContent = `Field ${i + 1}:`;
            label.className = 'text-xs text-gray-600 w-20 flex-shrink-0';
            label.htmlFor = `field-${i}`;

            const input = document.createElement('input');
            input.type = 'text';
            input.id = `field-${i}`;
            input.name = `field-${i}`;
            input.value = randomValue(i);
            input.className = 'flex-1 px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500';

            fieldDiv.appendChild(label);
            fieldDiv.appendChild(input);
            form.appendChild(fieldDiv);

            // Log progress every 500 fields
            if ((i + 1) % 500 === 0) {
                console.log(`Generated ${i + 1} fields...`);
            }
        }

        console.log(`âœ“ Generated ${fieldCount} fields`);
        console.log(`Estimated YAML size: ~${Math.round(fieldCount * 1.1 / 1024)}MB`);
        console.log('Change any field value to trigger a scan with multiscan endpoint');
    </script>
</body>
</html>
